\chapter{2.2.0 / 2025-\/03-\/26}
\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y}{}\label{md_node__modules_2router_2_h_i_s_t_o_r_y}\index{2.2.0 / 2025-\/03-\/26@{2.2.0 / 2025-\/03-\/26}}

\begin{DoxyItemize}
\item Remove {\ttfamily set\+Immediate} support check
\item Restore {\ttfamily debug} dependency
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3444}{}\doxysection{\texorpdfstring{2.\+1.\+0 / 2025-\/02-\/10}{2.\+1.\+0 / 2025-\/02-\/10}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3444}

\begin{DoxyItemize}
\item Updated {\ttfamily engines} field to Node@18 or higher
\item Remove {\ttfamily Object.\+set\+Prototype\+Of} polyfill
\item Use {\ttfamily Array.\+flat} instead of {\ttfamily array-\/flatten} package
\item Replace {\ttfamily methods} dependency with standard library
\item deps\+: parseurl@\texorpdfstring{$^\wedge$}{\string^}1.3.\+3
\item deps\+: is-\/promise@\texorpdfstring{$^\wedge$}{\string^}4.0.\+0
\item Replace {\ttfamily utils-\/merge} dependency with {\ttfamily Object.\+assign}
\item deps\+: Remove unused dep {\ttfamily after}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3445}{}\doxysection{\texorpdfstring{2.\+0.\+0 / 2024-\/09-\/09}{2.\+0.\+0 / 2024-\/09-\/09}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3445}

\begin{DoxyItemize}
\item Drop support for node \texorpdfstring{$<$}{<}18
\item deps\+: path-\/to-\/regexp@\texorpdfstring{$^\wedge$}{\string^}8.0.\+0
\begin{DoxyItemize}
\item Drop support for partial capture group `router.\+route('/user(s?)/\+:user/\+:op\textquotesingle{}){\ttfamily but still have optional non-\/capture}/user\{s\}/\+:user/\+:op{\ttfamily  -\/}\+:name?{\ttfamily becomes}\{\+:name\}{\ttfamily  -\/}\+:name\texorpdfstring{$\ast$}{*}{\ttfamily becomes}\texorpdfstring{$\ast$}{*}name{\ttfamily .}
\item {\ttfamily The splat change also changes splat from strings to an array of strings}
\item {\ttfamily Optional splats become}\{\texorpdfstring{$\ast$}{*}name\}{\ttfamily  -\/}\+:name+{\ttfamily becomes}\texorpdfstring{$\ast$}{*}name{\ttfamily and thus equivalent to}\texorpdfstring{$\ast$}{*}name\`{} so I dropped those tests
\item Strings as regular expressions are fully removed, need to be converted to native regular expressions
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3446}{}\doxysection{\texorpdfstring{2.\+0.\+0-\/beta.\+2 / 2024-\/03-\/20}{2.\+0.\+0-\/beta.\+2 / 2024-\/03-\/20}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3446}
This incorporates all changes after 1.\+3.\+5 up to 1.\+3.\+8.


\begin{DoxyItemize}
\item Add support for returned, rejected Promises to {\ttfamily router.\+param}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3447}{}\doxysection{\texorpdfstring{2.\+0.\+0-\/beta.\+1 / 2020-\/03-\/29}{2.\+0.\+0-\/beta.\+1 / 2020-\/03-\/29}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3447}
This incorporates all changes after 1.\+3.\+3 up to 1.\+3.\+5.


\begin{DoxyItemize}
\item Internalize private {\ttfamily router.\+process\+\_\+params} method
\item Remove {\ttfamily debug} dependency
\item deps\+: array-\/flatten@3.\+0.\+0
\item deps\+: parseurl1.\+3.\+3
\item deps\+: path-\/to-\/regexp@3.\+2.\+0
\begin{DoxyItemize}
\item Add new {\ttfamily ?}, {\ttfamily \texorpdfstring{$\ast$}{*}}, and {\ttfamily +} parameter modifiers.
\item Matching group expressions are only Reg\+Exp syntax. {\ttfamily (\texorpdfstring{$\ast$}{*})} is no longer valid and must be written as {\ttfamily (.\texorpdfstring{$\ast$}{*})}, for example.
\item Named matching groups no longer available by position in {\ttfamily req.\+params}. {\ttfamily /\+:foo(.\texorpdfstring{$\ast$}{*})} only captures as {\ttfamily req.\+params.\+foo} and not available as {\ttfamily req.\+params\mbox{[}0\mbox{]}}.
\item Regular expressions can only be used in a matching group. {\ttfamily /\textbackslash{}\textbackslash{}d+} is no longer valid and must be written as {\ttfamily /(\textbackslash{}\textbackslash{}d+)}.
\item Matching groups are now literal regular expressions. {\ttfamily \+:foo} named captures can no longer be included inside a capture group.
\item Special {\ttfamily \texorpdfstring{$\ast$}{*}} path segment behavior removed. {\ttfamily /foo/\texorpdfstring{$\ast$}{*}/bar} will match a literal {\ttfamily \texorpdfstring{$\ast$}{*}} as the middle segment.
\end{DoxyItemize}
\item deps\+: setprototypeof@1.\+2.\+0
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3448}{}\doxysection{\texorpdfstring{2.\+0.\+0-\/alpha.\+1 / 2018-\/07-\/27}{2.\+0.\+0-\/alpha.\+1 / 2018-\/07-\/27}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3448}

\begin{DoxyItemize}
\item Add basic support for returned, rejected Promises
\begin{DoxyItemize}
\item Rejected Promises from middleware functions {\ttfamily next(error)}
\end{DoxyItemize}
\item Drop support for Node.\+js below 0.\+10
\item deps\+: debug@3.\+1.\+0
\begin{DoxyItemize}
\item Add {\ttfamily DEBUG\+\_\+\+HIDE\+\_\+\+DATE} environment variable
\item Change timer to per-\/namespace instead of global
\item Change non-\/\+TTY date format
\item Remove {\ttfamily DEBUG\+\_\+\+FD} environment variable support
\item Support 256 namespace colors
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3449}{}\doxysection{\texorpdfstring{1.\+3.\+8 / 2023-\/02-\/24}{1.\+3.\+8 / 2023-\/02-\/24}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3449}

\begin{DoxyItemize}
\item Fix routing requests without method
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3450}{}\doxysection{\texorpdfstring{1.\+3.\+7 / 2022-\/04-\/28}{1.\+3.\+7 / 2022-\/04-\/28}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3450}

\begin{DoxyItemize}
\item Fix hanging on large stack of sync routes
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3451}{}\doxysection{\texorpdfstring{1.\+3.\+6 / 2021-\/11-\/15}{1.\+3.\+6 / 2021-\/11-\/15}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3451}

\begin{DoxyItemize}
\item Fix handling very large stacks of sync middleware
\item deps\+: safe-\/buffer@5.\+2.\+1
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3452}{}\doxysection{\texorpdfstring{1.\+3.\+5 / 2020-\/03-\/24}{1.\+3.\+5 / 2020-\/03-\/24}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3452}

\begin{DoxyItemize}
\item Fix incorrect middleware execution with unanchored {\ttfamily Reg\+Exp}s
\item perf\+: use plain object for internal method map
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3453}{}\doxysection{\texorpdfstring{1.\+3.\+4 / 2020-\/01-\/24}{1.\+3.\+4 / 2020-\/01-\/24}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3453}

\begin{DoxyItemize}
\item deps\+: array-\/flatten@3.\+0.\+0
\item deps\+: parseurl1.\+3.\+3
\item deps\+: setprototypeof@1.\+2.\+0
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3454}{}\doxysection{\texorpdfstring{1.\+3.\+3 / 2018-\/07-\/06}{1.\+3.\+3 / 2018-\/07-\/06}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3454}

\begin{DoxyItemize}
\item Fix JSDoc for {\ttfamily Router} constructor
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3455}{}\doxysection{\texorpdfstring{1.\+3.\+2 / 2017-\/09-\/24}{1.\+3.\+2 / 2017-\/09-\/24}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3455}

\begin{DoxyItemize}
\item deps\+: debug@2.\+6.\+9
\item deps\+: parseurl1.\+3.\+2
\begin{DoxyItemize}
\item perf\+: reduce overhead for full URLs
\item perf\+: unroll the "{}fast-\/path"{} {\ttfamily Reg\+Exp}
\end{DoxyItemize}
\item deps\+: setprototypeof@1.\+1.\+0
\item deps\+: utils-\/merge@1.\+0.\+1
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3456}{}\doxysection{\texorpdfstring{1.\+3.\+1 / 2017-\/05-\/19}{1.\+3.\+1 / 2017-\/05-\/19}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3456}

\begin{DoxyItemize}
\item deps\+: debug@2.\+6.\+8
\begin{DoxyItemize}
\item Fix {\ttfamily DEBUG\+\_\+\+MAX\+\_\+\+ARRAY\+\_\+\+LENGTH}
\item deps\+: ms@2.\+0.\+0
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3457}{}\doxysection{\texorpdfstring{1.\+3.\+0 / 2017-\/02-\/25}{1.\+3.\+0 / 2017-\/02-\/25}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3457}

\begin{DoxyItemize}
\item Add {\ttfamily next("{}router"{})} to exit from router
\item Fix case where {\ttfamily router.\+use} skipped requests routes did not
\item Use {\ttfamily o} in path debug to tell types apart
\item deps\+: setprototypeof@1.\+0.\+3
\item perf\+: add fast match path for {\ttfamily \texorpdfstring{$\ast$}{*}} route
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3458}{}\doxysection{\texorpdfstring{1.\+2.\+0 / 2017-\/02-\/17}{1.\+2.\+0 / 2017-\/02-\/17}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3458}

\begin{DoxyItemize}
\item Skip routing when {\ttfamily req.\+url} is not set
\item deps\+: debug@2.\+6.\+1
\begin{DoxyItemize}
\item Allow colors in workers
\item Deprecated {\ttfamily DEBUG\+\_\+\+FD} environment variable set to {\ttfamily 3} or higher
\item Fix error when running under React Native
\item Use same color for same namespace
\item deps\+: ms@0.\+7.\+2
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3459}{}\doxysection{\texorpdfstring{1.\+1.\+5 / 2017-\/01-\/28}{1.\+1.\+5 / 2017-\/01-\/28}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3459}

\begin{DoxyItemize}
\item deps\+: array-\/flatten@2.\+1.\+1
\item deps\+: setprototypeof@1.\+0.\+2
\begin{DoxyItemize}
\item Fix using fallback even when native method exists
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3460}{}\doxysection{\texorpdfstring{1.\+1.\+4 / 2016-\/01-\/21}{1.\+1.\+4 / 2016-\/01-\/21}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3460}

\begin{DoxyItemize}
\item deps\+: array-\/flatten@2.\+0.\+0
\item deps\+: methods1.\+1.\+2
\begin{DoxyItemize}
\item perf\+: enable strict mode
\end{DoxyItemize}
\item deps\+: parseurl1.\+3.\+1
\begin{DoxyItemize}
\item perf\+: enable strict mode
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3461}{}\doxysection{\texorpdfstring{1.\+1.\+3 / 2015-\/08-\/02}{1.\+1.\+3 / 2015-\/08-\/02}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3461}

\begin{DoxyItemize}
\item Fix infinite loop condition using {\ttfamily merge\+Params\+: true}
\item Fix inner numeric indices incorrectly altering parent {\ttfamily req.\+params}
\item deps\+: array-\/flatten@1.\+1.\+1
\begin{DoxyItemize}
\item perf\+: enable strict mode
\end{DoxyItemize}
\item deps\+: path-\/to-\/regexp@0.\+1.\+7
\begin{DoxyItemize}
\item Fix regression with escaped round brackets and matching groups
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3462}{}\doxysection{\texorpdfstring{1.\+1.\+2 / 2015-\/07-\/06}{1.\+1.\+2 / 2015-\/07-\/06}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3462}

\begin{DoxyItemize}
\item Fix hiding platform issues with {\ttfamily decode\+URIComponent}
\begin{DoxyItemize}
\item Only {\ttfamily URIError}s are a 400
\end{DoxyItemize}
\item Fix using {\ttfamily \texorpdfstring{$\ast$}{*}} before params in routes
\item Fix using capture groups before params in routes
\item deps\+: path-\/to-\/regexp@0.\+1.\+6
\item perf\+: enable strict mode
\item perf\+: remove argument reassignments in routing
\item perf\+: skip attempting to decode zero length string
\item perf\+: use plain for loops
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3463}{}\doxysection{\texorpdfstring{1.\+1.\+1 / 2015-\/05-\/25}{1.\+1.\+1 / 2015-\/05-\/25}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3463}

\begin{DoxyItemize}
\item Fix issue where `next(\textquotesingle{}route'){\ttfamily in}router.\+param\`{} would incorrectly skip values
\item deps\+: array-\/flatten@1.\+1.\+0
\item deps\+: debug2.\+2.\+0
\begin{DoxyItemize}
\item deps\+: ms@0.\+7.\+1
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3464}{}\doxysection{\texorpdfstring{1.\+1.\+0 / 2015-\/04-\/22}{1.\+1.\+0 / 2015-\/04-\/22}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3464}

\begin{DoxyItemize}
\item Use {\ttfamily setprototypeof} instead of {\ttfamily \+\_\+\+\_\+proto\+\_\+\+\_\+}
\item deps\+: debug2.\+1.\+3
\begin{DoxyItemize}
\item Fix high intensity foreground color for bold
\item deps\+: ms@0.\+7.\+0
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3465}{}\doxysection{\texorpdfstring{1.\+0.\+0 / 2015-\/01-\/13}{1.\+0.\+0 / 2015-\/01-\/13}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3465}

\begin{DoxyItemize}
\item Fix crash from error within {\ttfamily OPTIONS} response handler
\item deps\+: array-\/flatten@1.\+0.\+2
\begin{DoxyItemize}
\item Remove redundant code path
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3466}{}\doxysection{\texorpdfstring{1.\+0.\+0-\/beta.\+3 / 2015-\/01-\/11}{1.\+0.\+0-\/beta.\+3 / 2015-\/01-\/11}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3466}

\begin{DoxyItemize}
\item Fix duplicate methods appearing in OPTIONS responses
\item Fix OPTIONS responses to include the HEAD method properly
\item Remove support for leading colon in {\ttfamily router.\+param(name, fn)}
\item Use {\ttfamily array-\/flatten} for flattening arrays
\item deps\+: debug2.\+1.\+1
\item deps\+: methods1.\+1.\+1
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3467}{}\doxysection{\texorpdfstring{1.\+0.\+0-\/beta.\+2 / 2014-\/11-\/19}{1.\+0.\+0-\/beta.\+2 / 2014-\/11-\/19}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3467}

\begin{DoxyItemize}
\item Match routes iteratively to prevent stack overflows
\end{DoxyItemize}\hypertarget{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3468}{}\doxysection{\texorpdfstring{1.\+0.\+0-\/beta.\+1 / 2014-\/11-\/16}{1.\+0.\+0-\/beta.\+1 / 2014-\/11-\/16}}\label{md_node__modules_2router_2_h_i_s_t_o_r_y_autotoc_md3468}

\begin{DoxyItemize}
\item Initial release ported from Express 4.\+x
\begin{DoxyItemize}
\item Altered to work without Express 
\end{DoxyItemize}
\end{DoxyItemize}